{"version":3,"sources":["felixhayashi/tiddlymap/js/lib/utils/thirdParty.js"],"names":["generateDraftTitle","title","c","draftTitle","$tw","wiki","tiddlerExists","makeDraftTiddler","targetTitle","findDraft","getTiddler","draftTiddler","Tiddler","tiddler","getModificationFields","addTiddler","getFullScreenApis","db","d","result","_requestFullscreen","webkitExitFullscreen","undefined","mozRequestFullScreen","webkitFullscreenElement","msRequestFullscreen","requestFullscreen","_exitFullscreen","mozCancelFullScreen","msExitFullscreen","_fullscreenElement","mozFullScreenElement","msFullscreenElement","fullscreenElement","_fullscreenChange","flatten","target","opts","arguments","length","delimiter","prefix","isarray","output","step","object","prev","newKey","value","key","safe","Array","isArray","type","Object","prototype","toString","call","isobject","unflatten","forEach","getkey","split","key2","recipient","parsedKey","isNaN","indexOf","keys","key1","shift","genUUID","CHARS","chars","uuid","rnd","r","i","Math","random","join"],"mappings":"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","file":"../../../../../../felixhayashi/tiddlymap/js/lib/utils/thirdParty.js","sourcesContent":["// @preserve\n/*\\\n\ntitle: $:/plugins/felixhayashi/tiddlymap/js/lib/utils/thirdParty\ntype: application/javascript\nmodule-type: library\n\n@preserve\n\n\\*/\n\n/**\n * Modified TW-Code from Navigator widget\n * https://github.com/Jermolene/TiddlyWiki5/blob/master/core/modules/widgets/navigator.js\n */\nexport const generateDraftTitle = title => {\n\n  let c = 0,\n    draftTitle;\n  do {\n    draftTitle = 'Draft ' + (c ? (c + 1) + ' ' : '') + 'of \\'' + title + '\\'';\n    c++;\n  } while ($tw.wiki.tiddlerExists(draftTitle));\n  return draftTitle;\n\n};\n\n/**\n * Modified TW-Code from Navigator widget\n * https://github.com/Jermolene/TiddlyWiki5/blob/master/core/modules/widgets/navigator.js\n */\nexport const makeDraftTiddler = targetTitle => {\n\n  // See if there is already a draft tiddler for this tiddler\n  let draftTitle = $tw.wiki.findDraft(targetTitle);\n  if (draftTitle) {\n    return $tw.wiki.getTiddler(draftTitle);\n  }\n  // Get the current value of the tiddler we're editing\n  const tiddler = $tw.wiki.getTiddler(targetTitle);\n  // Save the initial value of the draft tiddler\n  draftTitle = generateDraftTitle(targetTitle);\n  const draftTiddler = new $tw.Tiddler(\n      tiddler,\n    {\n      title: draftTitle,\n      'draft.title': targetTitle,\n      'draft.of': targetTitle\n    },\n      $tw.wiki.getModificationFields()\n  );\n  $tw.wiki.addTiddler(draftTiddler);\n  return draftTiddler;\n\n};\n\n/**\n * TW-Code\n * @deprecated delete this in 2016 and use $tw.utils.getFullScreenApis instead\n */\nexport const getFullScreenApis = () => {\n\n  const d = document,\n    db = d.body,\n    result = {\n      '_requestFullscreen': db.webkitRequestFullscreen !== undefined ? 'webkitRequestFullscreen' :\n              db.mozRequestFullScreen !== undefined ? 'mozRequestFullScreen' :\n              db.msRequestFullscreen !== undefined ? 'msRequestFullscreen' :\n              db.requestFullscreen !== undefined ? 'requestFullscreen' : '',\n      '_exitFullscreen': d.webkitExitFullscreen !== undefined ? 'webkitExitFullscreen' :\n              d.mozCancelFullScreen !== undefined ? 'mozCancelFullScreen' :\n              d.msExitFullscreen !== undefined ? 'msExitFullscreen' :\n              d.exitFullscreen !== undefined ? 'exitFullscreen' : '',\n      '_fullscreenElement': d.webkitFullscreenElement !== undefined ? 'webkitFullscreenElement' :\n              d.mozFullScreenElement !== undefined ? 'mozFullScreenElement' :\n              d.msFullscreenElement !== undefined ? 'msFullscreenElement' :\n              d.fullscreenElement !== undefined ? 'fullscreenElement' : '',\n      '_fullscreenChange': d.webkitFullscreenElement !== undefined ? 'webkitfullscreenchange' :\n              d.mozFullScreenElement !== undefined ? 'mozfullscreenchange' :\n              d.msFullscreenElement !== undefined ? 'MSFullscreenChange' :\n              d.fullscreenElement !== undefined ? 'fullscreenchange' : ''\n    };\n  if (!result._requestFullscreen || !result._exitFullscreen || !result._fullscreenElement) {\n    return null;\n  } else {\n    return result;\n  }\n\n};\n\n/**\n *\n * Slightly modified by me to allow an optional prefix.\n *\n * For the original code:\n *\n * Copyright (c) 2014, Hugh Kennedy, All rights reserved.\n * Code published under the BSD 3-Clause License\n *\n * @see oringal repo https://github.com/hughsk/flat\n * @see snapshot https://github.com/felixhayashi/flat\n * @see http://opensource.org/licenses/BSD-3-Clause\n */\nexport const flatten = (target, opts = {}) => {\n\n  var delimiter = opts.delimiter || '.';\n  var prefix = opts.prefix || '';\n  var output = {};\n\n  function step(object, prev) {\n    Object.keys(object).forEach(function(key) {\n      var value = object[key];\n      var isarray = opts.safe && Array.isArray(value);\n      var type = Object.prototype.toString.call(value);\n      var isobject = (\n        type === '[object Object]' ||\n        type === '[object Array]'\n      );\n\n      var newKey = prev\n        ? prev + delimiter + key\n        : prefix + key;\n\n      if (!isarray && isobject) {\n        return step(value, newKey);\n      }\n\n      output[newKey] = value;\n    });\n  }\n\n  step(target);\n\n  return output;\n\n};\n\n\n/**\n * Copyright (c) 2014, Hugh Kennedy, All rights reserved.\n * Code published under the BSD 3-Clause License\n *\n * @see oringal repo https://github.com/hughsk/flat\n * @see snapshot https://github.com/felixhayashi/flat\n * @see http://opensource.org/licenses/BSD-3-Clause\n */\nexport const unflatten = (target, opts = {}) => {\n\n  var delimiter = opts.delimiter || '.';\n  var result = {};\n\n  if (Object.prototype.toString.call(target) !== '[object Object]') {\n    return target;\n  }\n\n  // safely ensure that the key is\n  // an integer.\n  function getkey(key) {\n    var parsedKey = Number(key);\n\n    return (\n      isNaN(parsedKey) ||\n      key.indexOf('.') !== -1\n    ) ? key\n      : parsedKey;\n  }\n\n  Object.keys(target).forEach(function(key) {\n    var split = key.split(delimiter);\n    var key1 = getkey(split.shift());\n    var key2 = getkey(split[0]);\n    var recipient = result;\n\n    while (key2 !== undefined) {\n      if (recipient[key1] === undefined) {\n        recipient[key1] = (\n          typeof key2 === 'number' &&\n          !opts.object ? [] : {}\n        );\n      }\n\n      recipient = recipient[key1];\n      if (split.length > 0) {\n        key1 = getkey(split.shift());\n        key2 = getkey(split[0]);\n      }\n    }\n\n    // unflatten again for 'messy objects'\n    recipient[key1] = unflatten(target[key], opts);\n  });\n\n  return result;\n\n};\n\n\n/**\n * An adopted version of pmario's version to create\n * uuids of type RFC4122, version 4 ID.\n *\n * Shortened version:\n * pmario (1.0 - 2011.05.22):\n * http://chat-plugins.tiddlyspace.com/#UUIDPlugin\n *\n * Original version:\n * Math.uuid.js (v1.4)\n * http://www.broofa.com\n * mailto:robert@broofa.com\n *\n * Copyright (c) 2010 Robert Kieffer\n * Dual licensed under the MIT and GPL licenses.\n *\n * ---\n * @see https://github.com/almende/vis/issues/432\n*/\nexport const genUUID = (function() {\n\n  // Private array of chars to use\n  var CHARS = '0123456789abcdefghijklmnopqrstuvwxyz'.split('');\n\n  return function () {\n    var chars = CHARS, uuid = new Array(36);\n\n    var rnd=0, r;\n    for (var i = 0; i < 36; i++) {\n      if (i==8 || i==13 ||  i==18 || i==23) {\n        uuid[i] = '-';\n      } else if (i==14) {\n        uuid[i] = '4';\n      } else {\n        if (rnd <= 0x02) rnd = 0x2000000 + (Math.random()*0x1000000)|0;\n        r = rnd & 0xf;\n        rnd = rnd >> 4;\n        uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\n      }\n    }\n\n    return uuid.join('');\n  };\n\n})();\n"],"sourceRoot":"../../../../../../../src/plugins"}